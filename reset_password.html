<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Reset Password</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<img src="images/topLeft.png" alt="" class="corner-img top-left">
	<img src="images/bottomRight.png" alt="" class="corner-img bottom-right">
	<div class="box">
	<h1>Lajna Pittsburgh</h1>
	<h3>Create New Password</h3>
		<div id="message"></div>
		<form class="login-form" action="reset_password_process.php" method="POST" id="resetForm">
		<input type="hidden" name="token" id="tokenInput">
		<div class="form-group">
			<label for="password">New Password</label>
			<input type="password" id="password" name="password" placeholder="Enter new password (min 8 characters)" required/>
		</div>
		<div class="form-group">
			<label for="confirm_password">Confirm Password</label>
			<input type="password" id="confirm_password" name="confirm_password" placeholder="Re-enter new password" required/>
		</div>
		<button type="submit" name="submit">Reset Password</button>
		</form>
		<p style="margin-top: 20px;"><a href="login.php" style="color: #c4a484; text-decoration: none;">Back to Login</a></p>
	</div>
	<script>
		const urlParams = new URLSearchParams(window.location.search);
		const token = urlParams.get('token');
		const error = urlParams.get('error');
		const success = urlParams.get('success');
		
		if (token) {
			document.getElementById('tokenInput').value = token;
		} else if (!success) {
			document.getElementById('message').innerHTML = '<p style="color: red;">Invalid or expired reset link.</p>';
			document.getElementById('resetForm').style.display = 'none';
		}
		
		if (error === 'short_password') {
			document.getElementById('message').innerHTML = '<p style="color: red;">Password must be at least 8 characters long.</p>';
		} else if (error === 'no_match') {
			document.getElementById('message').innerHTML = '<p style="color: red;">Passwords do not match.</p>';
		} else if (error === 'invalid_token') {
			document.getElementById('message').innerHTML = '<p style="color: red;">This reset link is invalid or has expired.</p>';
			document.getElementById('resetForm').style.display = 'none';
		} else if (success === '1') {
			document.getElementById('message').innerHTML = '<p style="color: green;">Your password has been reset successfully. You can now login.</p>';
			document.getElementById('resetForm').style.display = 'none';
		}
	</script>
</body>
</html>
